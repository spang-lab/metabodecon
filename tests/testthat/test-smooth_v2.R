test_that("1. smooth_v1()", {
  y <- c(1, 4, 2, 4, 3)
  exp1 <- sapply(list(y[1:2], y[1:3], y[2:4], y[3:5], y[4:5]), mean)
  exp2 <- sapply(list(exp1[1:2], exp1[1:3], exp1[2:4], exp1[3:5], exp1[4:5]), mean)
  exp3 <- sapply(list(exp2[1:2], exp2[1:3], exp2[2:4], exp2[3:5], exp2[4:5]), mean)
  z1 <- smooth(y = y, k = 3, reps = 1)
  z2 <- smooth(y = y, k = 3, reps = 2)
  z3 <- smooth(y = y, k = 3, reps = 3)
  expect_equal(z1, exp1)
  expect_equal(z2, exp2)
  expect_equal(z3, exp3)
  y <- rnorm(10000)
  runtime_v1 <- system.time(z <- smooth(y = y, k = 5, reps = 10))
  runtime_v2 <- system.time(z <- smooth_v2(y = y, k = 5, reps = 10))
})